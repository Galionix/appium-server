# Instagram Automation Platform Design Document

## 1. Бизнес-требования

- Автоматизация пользовательских сценариев в Instagram (и других приложениях в будущем)
- Сценарии: лайкать видео, добавлять друзей, писать сообщения, просматривать сторис, комментировать, рандомизация поведения
- Возможность масштабирования на несколько физических устройств (телефонов)
- Модульная архитектура для легкого добавления новых приложений и сценариев
- Возможность интеграции с ИИ для генерации сценариев и текстов
- Веб-интерфейс для мониторинга и статистики по ботам/устройствам

## 2. Архитектурные решения

### 2.1. Основные компоненты

- **Core**: ядро платформы, управление устройствами, очередями задач, логированием
- **Device Manager**: управление подключением и состоянием устройств (Appium)
- **App Modules**: отдельные модули для каждого приложения (Instagram, Telegram и др.)
- **Scenario Engine**: генерация и выполнение сценариев (шаблоны, рандомизация, ИИ)
- **Task Scheduler**: планирование и распределение задач между устройствами
- **Web API**: REST API для управления ботами и сбора статистики
- **Frontend**: веб-интерфейс для мониторинга и управления

### 2.2. Модульная структура (Python)

```
/automation_platform
    /core
        device_manager.py
        task_scheduler.py
        logger.py
    /apps
        /instagram
            actions.py
            scenarios.py
            selectors.py
        /telegram
            ...
    /scenario_engine
        randomizer.py
        ai_generator.py
    /api
        web_api.py
    /frontend
        (отдельный проект, например на React/Vue)
    config.py
    main.py
```

### 2.3. Технологии и библиотеки

- **Appium** (Python client): управление Android/iOS устройствами
    - + Поддержка большинства мобильных приложений
    - - Требует настройки Appium server и устройств
- **FastAPI**: для реализации REST API
    - + Быстро, асинхронно, легко интегрируется
    - - Для сложных задач потребуется продвинутый роутинг
- **Celery** или **APScheduler**: для планирования задач и очередей
    - + Масштабируемо, поддержка распределенных очередей
    - - Требует брокер (Redis/RabbitMQ)
- **SQLAlchemy** или **Tortoise ORM**: для хранения статистики и логов
    - + Гибкость, поддержка разных БД
- **React/Vue**: для фронтенда
    - + Современный UI, легко интегрируется с REST API
- **OpenAI API** или **Llama.cpp**: для генерации текстов и сценариев
    - + Гибкость, возможность кастомизации
    - - Стоимость/ресурсы

### 2.4. Плюсы и минусы

- **Appium**: универсально, но требует физические устройства и настройки
- **FastAPI**: быстрое API, легко масштабируется
- **Celery**: распределенные задачи, но сложнее в настройке
- **Модульная структура**: легко расширять, но требует дисциплины в проектировании

## 3. Пример сценария (Instagram)

- Бот выбирает задачу (например, лайкнуть 3 видео)
- Заходит в Instagram
- Проверяет входящие сообщения
- Находит видео, смотрит и лайкает
- Случайно выбирает, добавить ли друга, написать ли сообщение и т.д.
- Все действия логируются и отправляются в API

## 4. Масштабирование

- Запуск на нескольких устройствах через Device Manager
- API для управления ботами и сбора статистики
- Фронтенд для мониторинга

## 5. Расширяемость

- Добавление новых приложений через новые модули в /apps
- Добавление новых сценариев через Scenario Engine
- Интеграция с ИИ для генерации сложных сценариев

---

### Рекомендация для старта:
- Начать с Python + Appium + FastAPI
- Сразу закладывать структуру под несколько приложений и устройств
- Для фронтенда — React или Vue, REST API через FastAPI
- Для очередей — APScheduler (если не нужен брокер) или Celery (если нужен)
- Для хранения — SQLite (на старте), потом PostgreSQL

---


---

## Основной список задач (приоритет: от сложного к простому)

1. **Масштабируемое управление физическими устройствами**
   - Подключение, мониторинг, управление несколькими телефонами одновременно
   - Обработка ошибок, переподключение, поддержка разных моделей

2. **Реализация сценариев сложного поведения в Instagram**
   - Навигация по приложению, обработка разных UI, обход защит от автоматизации
   - Рандомизация действий, имитация реального пользователя

3. **Интеграция с ИИ для генерации сценариев и текстов**
   - Использование LLM для создания уникальных сообщений, комментариев, сценариев

4. **Планировщик и очереди задач**
   - Распределение задач между устройствами, отслеживание статусов

5. **API для управления ботами и сбора статистики**
   - FastAPI, хранение логов, статистики, состояния устройств

6. **Веб-интерфейс для мониторинга и управления**
   - Просмотр статистики, управление задачами, визуализация состояния устройств

7. **Расширяемость под другие приложения**
   - Легкое добавление новых модулей для Telegram, WhatsApp и др.

8. **Документирование и тестирование**
   - Подробная документация, автотесты, примеры сценариев

---


---

## Чек-лист первоочередных задач (пошагово)


1. **Базовая инфраструктура и окружение**
   - [x] Установить и настроить Appium server
   - [x] Проверить работу ADB, подключение устройств
   - [x] Настроить Python окружение, установить зависимости (appium-python-client, fastapi, uvicorn)
   - [x] Создать базовую файловую структуру проекта


2. **Device Manager**
   - [x] Реализовать получение списка подключённых устройств через ADB
   - [x] Добавить мониторинг статуса устройств (онлайн/оффлайн)
   - [ ] Реализовать базовые методы управления устройствами (перезапуск, переподключение)


3. **API для устройств**
   - [x] Реализовать эндпоинт /devices для получения списка устройств
   - [ ] Добавить эндпоинты для управления устройствами (start, stop, restart)

4. **Instagram App Module**
   - Реализовать базовые действия: запуск приложения, навигация по главной, проверка входящих
   - Добавить сценарии: лайкнуть видео, добавить друга, отправить сообщение
   - Реализовать рандомизацию поведения

5. **Task Scheduler**
   - Реализовать очередь задач для устройств
   - Добавить планирование и распределение задач между устройствами

6. **Логирование и хранение статистики**
   - Реализовать базовый логгер
   - Настроить хранение логов и статистики (SQLite)

7. **Веб-интерфейс (минимум)**
   - Реализовать простую страницу для просмотра устройств и их статуса

8. **Документация и тесты**
   - Описать структуру проекта и основные сценарии
   - Добавить автотесты для ключевых компонентов

---

Двигаясь по этому чек-листу, можно быстро получить рабочий MVP и заложить основу для дальнейшего масштабирования.
